(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{6775:function(e,t,r){Promise.resolve().then(r.bind(r,6017))},2003:function(e,t,r){"use strict";r.d(t,{q:function(){return n}});var s=r(7437),a=r(2265);function n(e){let{children:t,fallback:r=null}=e,[n,l]=(0,a.useState)(!1);return((0,a.useEffect)(()=>{l(!0)},[]),n)?(0,s.jsx)(s.Fragment,{children:t}):(0,s.jsx)(s.Fragment,{children:r})}},3108:function(e,t,r){"use strict";r.d(t,{Bu:function(){return n}});var s=r(7437),a=r(166);let n=(0,a.default)(()=>r.e(363).then(r.bind(r,2363)).then(e=>e.BoundingBoxMap),{loadableGenerated:{webpack:()=>[2363]},ssr:!1,loading:()=>(0,s.jsx)("div",{className:"h-full w-full bg-gray-100 flex items-center justify-center",children:"Loading map..."})});(0,a.default)(()=>r.e(337).then(r.bind(r,3337)).then(e=>e.MapView),{loadableGenerated:{webpack:()=>[3337]},ssr:!1,loading:()=>(0,s.jsx)("div",{className:"h-[500px] w-full bg-gray-100 flex items-center justify-center",children:"Loading map..."})}),(0,a.default)(()=>r.e(25).then(r.bind(r,4025)).then(e=>e.RecordsMap),{loadableGenerated:{webpack:()=>[4025]},ssr:!1,loading:()=>(0,s.jsx)("div",{className:"h-full w-full bg-gray-100 flex items-center justify-center",children:"Loading map..."})}),(0,a.default)(()=>Promise.all([r.e(187),r.e(476),r.e(61)]).then(r.bind(r,9061)).then(e=>e.RecordDetailsDialog),{loadableGenerated:{webpack:()=>[9061]},ssr:!1})},5613:function(e,t,r){"use strict";r.d(t,{Cd:function(){return d},X:function(){return c},bZ:function(){return o}});var s=r(7437),a=r(2265),n=r(535),l=r(4508);let i=(0,n.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),o=a.forwardRef((e,t)=>{let{className:r,variant:a,...n}=e;return(0,s.jsx)("div",{ref:t,role:"alert",className:(0,l.cn)(i({variant:a}),r),...n})});o.displayName="Alert";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("h5",{ref:t,className:(0,l.cn)("mb-1 font-medium leading-none tracking-tight",r),...a})});d.displayName="AlertTitle";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("text-sm [&_p]:leading-relaxed",r),...a})});c.displayName="AlertDescription"},5974:function(e,t,r){"use strict";r.d(t,{C:function(){return i}});var s=r(7437);r(2265);var a=r(535),n=r(4508);let l=(0,a.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:t,variant:r,...a}=e;return(0,s.jsx)("div",{className:(0,n.cn)(l({variant:r}),t),...a})}},2869:function(e,t,r){"use strict";r.d(t,{z:function(){return d}});var s=r(7437),a=r(2265),n=r(7053),l=r(535),i=r(4508);let o=(0,l.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef((e,t)=>{let{className:r,variant:a,size:l,asChild:d=!1,...c}=e,u=d?n.g7:"button";return(0,s.jsx)(u,{className:(0,i.cn)(o({variant:a,size:l,className:r})),ref:t,...c})});d.displayName="Button"},6070:function(e,t,r){"use strict";r.d(t,{Ol:function(){return i},SZ:function(){return d},Zb:function(){return l},aY:function(){return c},eW:function(){return u},ll:function(){return o}});var s=r(7437),a=r(2265),n=r(4508);let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...a})});l.displayName="Card";let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",r),...a})});i.displayName="CardHeader";let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",r),...a})});o.displayName="CardTitle";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",r),...a})});d.displayName="CardDescription";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",r),...a})});c.displayName="CardContent";let u=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",r),...a})});u.displayName="CardFooter"},5186:function(e,t,r){"use strict";r.d(t,{I:function(){return l}});var s=r(7437),a=r(2265),n=r(4508);let l=a.forwardRef((e,t)=>{let{className:r,type:a,...l}=e;return(0,s.jsx)("input",{type:a,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...l})});l.displayName="Input"},3578:function(e,t,r){"use strict";r.d(t,{RM:function(){return o},SC:function(){return d},iA:function(){return l},pj:function(){return u},ss:function(){return c},xD:function(){return i}});var s=r(7437),a=r(2265),n=r(4508);let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{className:"relative w-full overflow-auto",children:(0,s.jsx)("table",{ref:t,className:(0,n.cn)("w-full caption-bottom text-sm",r),...a})})});l.displayName="Table";let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("thead",{ref:t,className:(0,n.cn)("[&_tr]:border-b",r),...a})});i.displayName="TableHeader";let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("tbody",{ref:t,className:(0,n.cn)("[&_tr:last-child]:border-0",r),...a})});o.displayName="TableBody",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("tfoot",{ref:t,className:(0,n.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",r),...a})}).displayName="TableFooter";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("tr",{ref:t,className:(0,n.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",r),...a})});d.displayName="TableRow";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("th",{ref:t,className:(0,n.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",r),...a})});c.displayName="TableHead";let u=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("td",{ref:t,className:(0,n.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",r),...a})});u.displayName="TableCell",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("caption",{ref:t,className:(0,n.cn)("mt-4 text-sm text-muted-foreground",r),...a})}).displayName="TableCaption"},2339:function(e,t,r){"use strict";r.d(t,{SP:function(){return d},dr:function(){return o},mQ:function(){return i},nU:function(){return c}});var s=r(7437),a=r(2265),n=r(271),l=r(4508);let i=n.fC,o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(n.aV,{ref:t,className:(0,l.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",r),...a})});o.displayName=n.aV.displayName;let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(n.xz,{ref:t,className:(0,l.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",r),...a})});d.displayName=n.xz.displayName;let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(n.VY,{ref:t,className:(0,l.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",r),...a})});c.displayName=n.VY.displayName},6818:function(e,t,r){"use strict";r.d(t,{g:function(){return l}});var s=r(7437),a=r(2265),n=r(4508);let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("textarea",{className:(0,n.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...a})});l.displayName="Textarea"},6017:function(e,t,r){"use strict";r.d(t,{UploadForm:function(){return F}});var s=r(7437),a=r(2265),n=r(2869),l=r(6070),i=r(2339),o=r(5186),d=r(3774),c=r(9322),u=r(5613),f=r(1535),m=r(3108),x=r(2003);function p(e){let{onRegionSelected:t,markers:r=[]}=e,[i,p]=(0,a.useState)(""),[g,h]=(0,a.useState)(null),[v,b]=(0,a.useState)(!1),[j,N]=(0,a.useState)(""),y=async()=>{if(i){b(!0),N("");try{if(await (0,f.M4)(),!window.google){N("Google Maps API not available"),b(!1);return}new window.google.maps.Geocoder().geocode({address:i},(e,r)=>{if("OK"===r&&e&&e.length>0){let r=e[0].geometry.viewport,s={north:r.getNorthEast().lat(),east:r.getNorthEast().lng(),south:r.getSouthWest().lat(),west:r.getSouthWest().lng()};h(s),t(i,s),b(!1),console.log("regionName (in geographic): ",i),console.log("boundingBox (in geographic): ",g)}else N("Could not find region: ".concat(r)),b(!1)})}catch(e){N("Error loading Google Maps API"),b(!1),console.error(e)}}};return(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsxs)("div",{className:"flex items-center mb-4",children:[(0,s.jsx)("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-primary-200 text-white mr-2",children:(0,s.jsx)("span",{className:"text-sm font-bold",children:"1"})}),(0,s.jsx)("h2",{className:"text-xl font-semibold",children:"Define Geographic Region"})]}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:'Enter a region name (e.g., "Durham Region, ON") to get its bounding box coordinates'}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{htmlFor:"region-name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Region Name"}),(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsx)(o.I,{id:"region-name",value:i,onChange:e=>p(e.target.value),placeholder:"e.g., Durham Region, ON",className:"flex-1"}),(0,s.jsx)(n.z,{style:{backgroundColor:"#3b82f6",color:"white"},onClick:y,disabled:!i||v,className:"bg-primary-200 hover:bg-primary-300",children:v?(0,s.jsxs)("span",{className:"flex items-center",children:[(0,s.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Loading..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.Z,{className:"mr-2 h-4 w-4"}),"Get Bounding Box"]})})]}),(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsx)(n.z,{variant:"outline",onClick:()=>{let e="Durham Region, ON",r={north:44.5167599,east:-78.324079,south:43.520641,west:-79.327997};p(e),h(r),t(e,r)},className:"text-sm",children:"Use Demo Region (Durham Region, ON)"})})]}),j&&(0,s.jsxs)(u.bZ,{variant:"destructive",className:"mb-4",children:[(0,s.jsx)(c.Z,{className:"h-4 w-4"}),(0,s.jsx)(u.X,{children:j})]}),g&&(0,s.jsx)(l.Zb,{className:"bg-gray-50",children:(0,s.jsxs)(l.aY,{className:"p-4",children:[(0,s.jsx)("div",{className:"text-sm text-gray-500 mb-2",children:(0,s.jsxs)("span",{className:"flex items-center",children:[(0,s.jsx)(d.Z,{className:"h-4 w-4 mr-1"}),"Bounding box for ",i]})}),(0,s.jsx)("div",{className:"h-[400px] border border-gray-300 rounded-md overflow-hidden",children:(0,s.jsx)(x.q,{fallback:(0,s.jsx)("div",{className:"flex items-center justify-center h-full",children:"Loading map..."}),children:(0,s.jsx)(m.Bu,{boundingBox:g,markers:r})})})]})})]})}var g=r(3578),h=r(5974),v=r(8736);function b(e){let{results:t,onViewOnMap:r}=e;return 0===t.length?null:(0,s.jsxs)(l.Zb,{className:"mt-8",children:[(0,s.jsx)(l.Ol,{children:(0,s.jsx)(l.ll,{className:"text-xl",children:"Processing Results"})}),(0,s.jsx)(l.aY,{children:(0,s.jsxs)(g.iA,{children:[(0,s.jsx)(g.xD,{children:(0,s.jsxs)(g.SC,{children:[(0,s.jsx)(g.ss,{children:"Filename"}),(0,s.jsx)(g.ss,{children:"Status"}),(0,s.jsx)(g.ss,{children:"Coordinates"}),(0,s.jsx)(g.ss,{children:"Metadata"}),(0,s.jsx)(g.ss,{children:"Actions"})]})}),(0,s.jsx)(g.RM,{children:t.map(e=>(0,s.jsxs)(g.SC,{children:[(0,s.jsx)(g.pj,{className:"font-medium",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(v.Z,{className:"h-4 w-4 mr-2 text-gray-500"}),e.filename]})}),(0,s.jsx)(g.pj,{children:(0,s.jsx)(h.C,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:e.status})}),(0,s.jsx)(g.pj,{children:(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsxs)("div",{children:["Lat: ",e.coordinates.lat.toFixed(6)]}),(0,s.jsxs)("div",{children:["Lng: ",e.coordinates.lng.toFixed(6)]})]})}),(0,s.jsx)(g.pj,{children:(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Title:"})," ",e.metadata.title]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Date:"})," ",e.metadata.date]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Scale:"})," ",e.metadata.scale]})]})}),(0,s.jsx)(g.pj,{children:(0,s.jsxs)("button",{onClick:()=>r(e.id),className:"flex items-center text-sm text-primary-200 hover:text-primary-300",children:[(0,s.jsx)(d.Z,{className:"h-4 w-4 mr-1"}),"View on Map"]})})]},e.id))})]})})]})}var j=r(5598),N=r(8156),y=r(9658),w=r(2489),S=r(4508);function O(e){let{files:t,setFiles:r}=e,l=(0,a.useCallback)(e=>{r([...t,...e])},[t,r]),{getRootProps:i,getInputProps:o,isDragActive:d}=(0,j.uI)({onDrop:l,accept:{"application/json":[".json"],"application/pdf":[".pdf"],"text/csv":[".csv"],"application/vnd.ms-excel":[".xls"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"]},maxSize:10485760}),c=e=>{let s=[...t];s.splice(e,1),r(s)};return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{...i(),className:"border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors ".concat(d?"border-primary bg-primary/5":"border-gray-300 hover:border-primary"),children:[(0,s.jsx)("input",{...o()}),(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center gap-2",children:[(0,s.jsx)(N.Z,{className:"h-10 w-10 text-gray-400"}),(0,s.jsx)("p",{className:"text-sm font-medium",children:d?"Drop files here":"Upload files or drag and drop"}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"CSV, Excel, JSON, or PDF up to 10MB"})]})]}),t.length>0&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Upload Files"}),(0,s.jsx)("ul",{className:"space-y-2",children:t.map((e,t)=>(0,s.jsxs)("li",{className:"flex items-center justify-between rounded-md border p-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:["application/pdf"===e.type?(0,s.jsx)(v.Z,{className:"h-5 w-5 text-red-500"}):"application/json"===e.type?(0,s.jsx)(y.Z,{className:"h-5 w-5 text-yellow-500"}):(0,s.jsx)(y.Z,{className:"h-5 w-5 text-blue-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:e.name}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:(0,S.td)(e.size)})]})]}),(0,s.jsxs)(n.z,{variant:"ghost",size:"icon",onClick:()=>c(t),children:[(0,s.jsx)(w.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Remove file"})]})]},t))})]})]})}var R=r(6818),k=r(5153),C=r(401),T=r(7689),D=r(2735),_=r(7342);function J(e){let{value:t,onChange:r}=e,[i,o]=(0,a.useState)(null),[d,u]=(0,a.useState)(!1),f=(0,a.useRef)(null),{toast:m}=(0,k.pm)(),x=e=>{let t=new FileReader;t.onload=t=>{try{var s;let a=null===(s=t.target)||void 0===s?void 0:s.result;JSON.parse(a),r(a),o(!0),m({title:"JSON file loaded",description:"Successfully loaded ".concat(e.name)})}catch(e){o(!1),m({title:"Invalid JSON file",description:"The file does not contain valid JSON data.",variant:"destructive"})}},t.readAsText(e)},p=async()=>{try{let e=await fetch("/sample-assets.json"),t=await e.text();r(t),o(!0),m({title:"Sample loaded",description:"Sample asset data has been loaded into the editor."})}catch(e){m({title:"Error loading sample",description:"Could not load the sample data.",variant:"destructive"})}};return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"relative border-2 rounded-lg transition-colors ".concat(d?"border-primary border-dashed bg-primary/5":!0===i?"border-green-500":!1===i?"border-red-500":"border-gray-200"),onDragOver:e=>{e.preventDefault(),u(!0)},onDragLeave:()=>{u(!1)},onDrop:e=>{var t;e.preventDefault(),u(!1);let r=null===(t=e.dataTransfer.files)||void 0===t?void 0:t[0];r&&("application/json"===r.type||r.name.endsWith(".json")?x(r):m({title:"Invalid file type",description:"Please upload a JSON file.",variant:"destructive"}))},children:[(0,s.jsx)(R.g,{placeholder:"Paste your JSON data here...",className:"min-h-[300px] font-mono text-sm border-0 resize-none focus-visible:ring-0",value:t,onChange:e=>{r(e.target.value),o(null)}}),null!==i&&(0,s.jsx)("div",{className:"absolute top-3 right-3",children:i?(0,s.jsx)("div",{className:"bg-green-100 text-green-800 p-1 rounded-full",children:(0,s.jsx)(C.Z,{className:"h-4 w-4"})}):(0,s.jsx)("div",{className:"bg-red-100 text-red-800 p-1 rounded-full",children:(0,s.jsx)(c.Z,{className:"h-4 w-4"})})})]}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,s.jsx)(n.z,{variant:"outline",onClick:()=>{if(!t.trim()){o(null);return}try{JSON.parse(t),o(!0),m({title:"Valid JSON",description:"Your JSON data is valid."})}catch(e){o(!1),m({title:"Invalid JSON",description:e instanceof Error?e.message:"Please check your JSON syntax.",variant:"destructive"})}},children:"Validate JSON"}),(0,s.jsx)(n.z,{variant:"outline",onClick:()=>{if(t.trim())try{let e=JSON.parse(t),s=JSON.stringify(e,null,2);r(s),o(!0),m({title:"JSON formatted",description:"Your JSON data has been formatted."})}catch(e){o(!1),m({title:"Invalid JSON",description:"Cannot format invalid JSON data.",variant:"destructive"})}},children:"Format JSON"}),(0,s.jsxs)(n.z,{variant:"outline",onClick:()=>{var e;null===(e=f.current)||void 0===e||e.click()},className:"flex items-center gap-2",children:[(0,s.jsx)(T.Z,{className:"h-4 w-4"}),"Upload JSON File"]}),(0,s.jsxs)(n.z,{variant:"outline",onClick:p,className:"flex items-center gap-2",children:[(0,s.jsx)(D.Z,{className:"h-4 w-4"}),"Load Sample Data"]}),(0,s.jsx)("input",{type:"file",ref:f,accept:".json,application/json",className:"hidden",onChange:e=>{var t;let r=null===(t=e.target.files)||void 0===t?void 0:t[0];r&&("application/json"===r.type||r.name.endsWith(".json")?x(r):m({title:"Invalid file type",description:"Please upload a JSON file.",variant:"destructive"}))}})]}),!t&&(0,s.jsx)(l.Zb,{className:"bg-muted/50",children:(0,s.jsxs)(l.aY,{className:"p-4 flex flex-col items-center justify-center text-center",children:[(0,s.jsx)(_.Z,{className:"h-12 w-12 text-muted-foreground mb-2"}),(0,s.jsx)("h3",{className:"text-sm font-medium",children:"Upload or paste JSON data"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Drag and drop a JSON file here, use the upload button, or paste JSON directly in the text area"})]})})]})}var A=r(9376),Z=r(6865),E=r(1817),M=r(2097);function F(){let[e,t]=(0,a.useState)([]),[r,o]=(0,a.useState)(""),[d,c]=(0,a.useState)(!1),[f,m]=(0,a.useState)("file"),[x,g]=(0,a.useState)(null),{toast:h}=(0,k.pm)(),v=(0,A.useRouter)(),{addRecords:j,setRecords:N}=(0,M.q)(),{records:y}=(0,M.q)(),[w,S]=(0,a.useState)([]),[R,C]=(0,a.useState)(""),[T,D]=(0,a.useState)(""),[_,F]=(0,a.useState)([]),I=(0,a.useRef)(null),[B,z]=(0,a.useState)(!1),[P,U]=(0,a.useState)(null),[V,G]=(0,a.useState)(null),L=async()=>{c(!0),g(null),z(!0),U(null),G(null);try{let t=[],r=new FormData;r.append("region",R),r.append("bbox",JSON.stringify(T)),Array.from(e).forEach(e=>r.append("files",e)),h({title:"Upload successful",description:"".concat(e.length," asset records have been uploaded.")});try{let e=await fetch("https://infra-mvp-api-195923635623.northamerica-northeast2.run.app/process",{method:"POST",body:r});console.log("Response:",e);let s=e.headers.get("content-type");if(null==s?void 0:s.includes("application/json")){let r=await e.json();console.log("âœ… JSON Response:",r),console.log(r),t=[r[0].metadata],G(t)}else{let t=await e.text();console.warn("\uD83D\uDCC4 Text Response:",t),U("Received non-JSON response from server")}}catch(e){console.error("\uD83D\uDEA8 Fetch error:",e),U(e.message||"Unknown error")}finally{N(t),console.log("Records to add:",y),z(!1)}v.push("/records")}catch(e){h({title:"Upload failed",description:"There was an error uploading your data. Please try again.",variant:"destructive"}),console.error(e)}finally{c(!1)}};return(0,s.jsxs)(l.Zb,{className:"max-w-3xl mx-auto",children:[(0,s.jsxs)(l.Ol,{children:[(0,s.jsx)("div",{ref:I,children:(0,s.jsx)(p,{onRegionSelected:(e,t)=>{C(e),D(t),console.log("Selected region:",R,"Bounding box:",T),console.log("regionName: ",R),console.log("boundingBox: ",T)},markers:_})}),(0,s.jsx)(b,{results:w,onViewOnMap:e=>{w.find(t=>t.id===e)&&I.current&&I.current.scrollIntoView({behavior:"smooth"})}})]}),(0,s.jsxs)(l.Ol,{children:[(0,s.jsx)(l.ll,{children:"Batch Upload Records"}),(0,s.jsx)(l.SZ,{children:"Upload your infrastructure asset records in bulk using a file or JSON data"})]}),(0,s.jsxs)(l.aY,{children:[(0,s.jsxs)(i.mQ,{defaultValue:"file",className:"w-full",onValueChange:m,children:[(0,s.jsxs)(i.dr,{className:"grid w-full grid-cols-2 mb-6",children:[(0,s.jsx)(i.SP,{value:"file",children:"File Upload"}),(0,s.jsx)(i.SP,{value:"json",children:"JSON Data"})]}),(0,s.jsx)(i.nU,{value:"file",children:(0,s.jsx)(O,{files:e,setFiles:t})}),(0,s.jsx)(i.nU,{value:"json",children:(0,s.jsx)(J,{value:r,onChange:o})})]}),x&&(0,s.jsxs)(u.bZ,{variant:"destructive",className:"mt-4",children:[(0,s.jsx)(Z.Z,{className:"h-4 w-4"}),(0,s.jsx)(u.Cd,{children:"Error"}),(0,s.jsx)(u.X,{children:x})]}),(0,s.jsx)(u.bZ,{className:"mt-4",children:(0,s.jsxs)(u.X,{children:["JSON data should follow this format:",(0,s.jsx)("pre",{className:"mt-2 p-2 bg-muted rounded-md text-xs overflow-auto",children:'[\n  {\n    "tiles": {\n      "tile_0_0": { "text_blob": "..." },\n      "tile_0_1": { "text_blob": "..." }\n    },\n    "georeference": {\n      "lat": 43.896933,\n      "lon": -78.843889,\n      "conf": 0.9,\n      "source": "google_intersection",\n      "trust_score": 0.9,\n      "fallback_used": false\n    },\n    "bounding_box": {\n      "southwest": { "lat": 43.52, "lng": -79.32 },\n      "northeast": { "lat": 44.51, "lng": -78.32 }\n    },\n    "text_blob_summary": "Summary of utility drawing..."\n  }\n]'})]})})]}),(0,s.jsx)(l.eW,{children:(0,s.jsx)(n.z,{className:"w-full",onClick:L,disabled:!!d||"file"===f&&0===e.length||"json"===f&&!r.trim(),children:d?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(E.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Uploading..."]}):"Upload Records"})})]})}},5153:function(e,t,r){"use strict";r.d(t,{pm:function(){return f}});var s=r(2265);let a=0,n=new Map,l=e=>{if(n.has(e))return;let t=setTimeout(()=>{n.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,t)},i=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?l(r):e.toasts.forEach(e=>{l(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},o=[],d={toasts:[]};function c(e){d=i(d,e),o.forEach(e=>{e(d)})}function u(e){let{...t}=e,r=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>c({type:"DISMISS_TOAST",toastId:r});return c({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||s()}}}),{id:r,dismiss:s,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function f(){let[e,t]=s.useState(d);return s.useEffect(()=>(o.push(t),()=>{let e=o.indexOf(t);e>-1&&o.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},1535:function(e,t,r){"use strict";r.d(t,{M4:function(){return i}});let s=!1,a=!1,n=null,l=null;function i(){return a&&window.google&&window.google.maps?Promise.resolve():l?Promise.reject(l):s&&n?n:(s=!0,n=new Promise((e,t)=>{try{let r=document.createElement("script");r.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBjTtkWH2LoiMVdjNZkgDPSa9gFKxpadpw&libraries=places",r.async=!0,r.defer=!0,r.onload=()=>{a=!0,s=!1,l=null,e()},r.onerror=e=>{s=!1,l=Error("Failed to load Google Maps API"),t(l)},document.head.appendChild(r)}catch(e){s=!1,l=e,t(e)}}))}},2097:function(e,t,r){"use strict";r.d(t,{q:function(){return n}});var s=r(3011),a=r(6885);let n=(0,s.U)()((0,a.tJ)(e=>({records:[],setRecords:t=>e({records:t}),addRecords:t=>e(e=>({records:[...e.records,...t]})),clearRecords:()=>e({records:[]})}),{name:"utilitx-storage"}))},4508:function(e,t,r){"use strict";r.d(t,{Uz:function(){return i},cn:function(){return n},td:function(){return l}});var s=r(1994),a=r(3335);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.m6)((0,s.W)(t))}function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===e)return"0 Bytes";let r=Math.floor(Math.log(e)/Math.log(1024));return Number.parseFloat((e/Math.pow(1024,r)).toFixed(t<0?0:t))+" "+["Bytes","KB","MB","GB","TB"][r]}function i(e){return e>=90?"bg-green-100 text-green-800":e>=80?"bg-lime-100 text-lime-800":e>=70?"bg-yellow-100 text-yellow-800":e>=60?"bg-orange-100 text-orange-800":"bg-red-100 text-red-800"}}},function(e){e.O(0,[203,824,175,971,117,744],function(){return e(e.s=6775)}),_N_E=e.O()}]);