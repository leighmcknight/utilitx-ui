"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[856],{4856:function(e,s,r){r.r(s),r.d(s,{default:function(){return N}});var l=r(7437),t=r(2265),a=r(1964),n=r(6070),o=r(6865),c=r(3774),i=r(5974),d=r(2869),m=r(2489),x=r(8736),h=r(9205);let u=(0,h.Z)("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]),g=(0,h.Z)("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);function f(e){let{record:s,onClose:r}=e;return s&&s.georeference?(0,l.jsxs)(n.Zb,{className:"w-full max-w-md shadow-lg border-primary/10 overflow-hidden max-h-[calc(100vh-120px)]",children:[(0,l.jsxs)(n.Ol,{className:"bg-primary/5 py-3 px-4 relative",children:[(0,l.jsxs)(d.z,{variant:"ghost",size:"icon",className:"absolute right-2 top-2 h-7 w-7 rounded-full",onClick:r,children:[(0,l.jsx)(m.Z,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"sr-only",children:"Close"})]}),(0,l.jsxs)(n.ll,{className:"text-base flex items-center gap-2",children:[(0,l.jsx)(c.Z,{className:"h-4 w-4 text-primary"}),"Asset Record Details"]})]}),(0,l.jsxs)(n.aY,{className:"p-0 overflow-y-auto max-h-[calc(100vh-180px)]",children:[(0,l.jsxs)("div",{className:"p-3 border-b",children:[(0,l.jsx)("h3",{className:"font-medium text-xs text-muted-foreground mb-2",children:"Location Information"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-y-1 text-sm",children:[(0,l.jsx)("div",{children:(0,l.jsx)("span",{className:"font-medium",children:"Latitude:"})}),(0,l.jsx)("div",{children:s.georeference.lat.toFixed(6)}),(0,l.jsx)("div",{children:(0,l.jsx)("span",{className:"font-medium",children:"Longitude:"})}),(0,l.jsx)("div",{children:s.georeference.lon.toFixed(6)}),(0,l.jsx)("div",{children:(0,l.jsx)("span",{className:"font-medium",children:"Source:"})}),(0,l.jsx)("div",{children:s.georeference.source||"N/A"}),s.georeference.intersection&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{children:(0,l.jsx)("span",{className:"font-medium",children:"Intersection:"})}),(0,l.jsx)("div",{children:s.georeference.intersection})]}),s.georeference.address&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{children:(0,l.jsx)("span",{className:"font-medium",children:"Address:"})}),(0,l.jsx)("div",{children:s.georeference.address})]})]})]}),(0,l.jsxs)("div",{className:"p-3 border-b",children:[(0,l.jsx)("h3",{className:"font-medium text-xs text-muted-foreground mb-2",children:"Quality Metrics"}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,l.jsxs)(i.C,{variant:"outline",className:"bg-primary/5",children:["Confidence: ",(100*s.georeference.conf).toFixed(0),"%"]}),(0,l.jsxs)(i.C,{variant:"outline",className:"bg-primary/5",children:["Trust Score: ",(100*s.georeference.trust_score).toFixed(0),"%"]}),(0,l.jsxs)(i.C,{variant:"outline",className:"bg-primary/5",children:["Fallback: ",s.georeference.fallback_used?"Yes":"No"]})]})]}),s.text_blob_summary&&(0,l.jsxs)("div",{className:"p-3 border-b",children:[(0,l.jsxs)("h3",{className:"font-medium text-xs text-muted-foreground mb-2 flex items-center gap-1.5",children:[(0,l.jsx)(x.Z,{className:"h-3.5 w-3.5"}),"Summary"]}),(0,l.jsx)("p",{className:"text-sm whitespace-pre-line",children:s.text_blob_summary})]}),s.tiles&&Object.keys(s.tiles).length>0&&(0,l.jsxs)("div",{className:"p-3 border-b",children:[(0,l.jsxs)("h3",{className:"font-medium text-xs text-muted-foreground mb-2 flex items-center gap-1.5",children:[(0,l.jsx)(u,{className:"h-3.5 w-3.5"}),"Text Extractions"]}),(0,l.jsx)("div",{className:"max-h-40 overflow-y-auto pr-2",children:Object.entries(s.tiles).map(e=>{let[s,r]=e;return(0,l.jsxs)("div",{className:"mb-2 last:mb-0",children:[(0,l.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:s}),(0,l.jsx)("p",{className:"text-sm bg-muted/30 p-2 rounded-md",children:r.text_blob})]},s)})})]}),(0,l.jsx)("div",{className:"p-3 bg-muted/10 flex justify-end",children:(0,l.jsxs)(d.z,{variant:"outline",size:"sm",className:"flex items-center gap-1.5 text-xs",children:[(0,l.jsx)(g,{className:"h-3 w-3"}),"View Full Details"]})})]})]}):null}var p=r(3354);let j={width:"100%",height:"100%",minHeight:"500px"},b={lat:56.1304,lng:-106.3468};function N(e){let{records:s,selectedRecord:r,onSelectRecord:i,getRecordId:d,onRecordUpdate:m}=e,x=(0,t.useRef)(null),[h,u]=(0,t.useState)(null),[g,N]=(0,t.useState)(!1),v=(0,p.X)(),{isLoaded:y,loadError:w}=(0,a.Ji)({googleMapsApiKey:"AIzaSyBm0xX2JVYtdsVnO78koeR6bIkBpz8hAYQ"});(0,t.useEffect)(()=>{w&&(console.error("Google Maps API error:",w),(w.message.includes("ApiProjectMapError")||w.message.includes("API key"))&&N(!0))},[w]);let k=()=>"red",C=s.filter(e=>e.georeference&&"number"==typeof e.georeference.lat&&"number"==typeof e.georeference.lon),A=(0,t.useCallback)(()=>{if(0===C.length||!y||!window.google)return null;let e=new window.google.maps.LatLngBounds;return C.forEach(s=>{e.extend({lat:s.georeference.lat,lng:s.georeference.lon})}),e},[C,y]);(0,t.useEffect)(()=>{if(x.current&&y&&window.google){let e=A();e&&(x.current.fitBounds(e),1===C.length&&x.current.setZoom(10))}},[C,y,A]),(0,t.useEffect)(()=>{if(r&&y){let e=C.find((e,s)=>d(e,s)===r);e&&(u(e),x.current&&x.current.panTo({lat:e.georeference.lat,lng:e.georeference.lon}))}else u(null)},[r,C,d,y]);let M=(0,t.useCallback)(e=>{x.current=e;let s=A();s&&e.fitBounds(s)},[A]),F=(0,t.useCallback)(()=>{x.current=null},[]),_=(e,s)=>{i(d(e,s))},I=(e,s,l)=>{if(!e.latLng||!m)return;let t=e.latLng.lat(),a=e.latLng.lng(),n={...s,georeference:{...s.georeference,lat:t,lon:a,source:s.georeference.source?"".concat(s.georeference.source," (adjusted)"):"manually adjusted"}};m(n,l),h&&d(s,l)===r&&u(n)},E=e=>window.google?{path:window.google.maps.SymbolPath.CIRCLE,fillColor:k(),fillOpacity:1,scale:e?10:8,strokeColor:"#FFFFFF",strokeWeight:2}:null;return g?(0,l.jsxs)("div",{className:"h-full min-h-[500px] flex flex-col",children:[(0,l.jsx)("div",{className:"bg-amber-50 border-amber-200 border p-4 rounded-md m-4",children:(0,l.jsxs)("div",{className:"flex items-start",children:[(0,l.jsx)(o.Z,{className:"h-5 w-5 text-amber-500 mr-2 mt-0.5"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"font-medium text-amber-800",children:"Google Maps API Key Error"}),(0,l.jsx)("p",{className:"text-sm text-amber-700 mt-1",children:"The Google Maps API key is invalid or has restrictions. Please check your API key configuration."}),(0,l.jsx)("div",{className:"mt-3",children:(0,l.jsx)("a",{href:"https://developers.google.com/maps/documentation/javascript/get-api-key",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline",children:"Learn how to set up a Google Maps API key"})})]})]})}),(0,l.jsxs)("div",{className:"flex-1 bg-gray-100 p-4 overflow-auto",children:[(0,l.jsxs)("h3",{className:"font-medium mb-3",children:["Asset Locations (",C.length,")"]}),(0,l.jsx)("div",{className:"grid gap-3",children:C.map((e,s)=>{let t=d(e,s),a=r===t;return(0,l.jsx)(n.Zb,{className:"p-3 cursor-pointer ".concat(a?"border-primary border-2":""),onClick:()=>_(e,s),children:(0,l.jsxs)("div",{className:"flex items-start",children:[(0,l.jsx)("div",{className:"w-6 h-6 rounded-full mr-3 mt-1 flex-shrink-0",style:{backgroundColor:k()}}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(c.Z,{className:"h-4 w-4 mr-1 text-gray-500"}),(0,l.jsxs)("span",{className:"text-sm font-medium",children:[e.georeference.lat.toFixed(4),", ",e.georeference.lon.toFixed(4)]})]}),e.georeference.source&&(0,l.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Source: ",e.georeference.source]}),e.georeference.intersection&&(0,l.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Intersection: ",e.georeference.intersection]}),e.text_blob_summary&&(0,l.jsx)("p",{className:"text-xs mt-2 line-clamp-2",children:e.text_blob_summary})]})]})},t)})})]})]}):w&&!g?(0,l.jsx)("div",{className:"flex items-center justify-center h-full min-h-[500px] bg-gray-100",children:(0,l.jsxs)("div",{className:"text-center p-4",children:[(0,l.jsx)("p",{className:"text-red-500 mb-2",children:"Error loading Google Maps"}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:w.message})]})}):y?(0,l.jsxs)("div",{className:"relative h-full",children:[(0,l.jsx)(a.b6,{mapContainerStyle:j,center:b,zoom:4,onLoad:M,onUnmount:F,options:{fullscreenControl:!1,mapTypeControl:!0,streetViewControl:!1,zoomControl:!0,mapTypeId:window.google?window.google.maps.MapTypeId.ROADMAP:void 0},children:C.map((e,s)=>{let t=d(e,s),n=r===t;return(0,l.jsx)(a.Jx,{position:{lat:e.georeference.lat,lng:e.georeference.lon},onClick:()=>_(e,s),icon:E(n),zIndex:n?1e3:1,animation:n&&window.google?window.google.maps.Animation.BOUNCE:void 0,draggable:!0,onDragEnd:r=>I(r,e,s)},t)})}),h&&(0,l.jsx)("div",{className:"absolute z-10 ".concat(v?"bottom-0 left-0 right-0 max-h-[70vh]":"top-4 right-4 max-w-md"),children:(0,l.jsx)(f,{record:h,onClose:()=>{i("")}})})]}):(0,l.jsx)("div",{className:"flex items-center justify-center h-full min-h-[500px] bg-gray-100",children:(0,l.jsx)("p",{children:"Loading Google Maps..."})})}},3774:function(e,s,r){r.d(s,{Z:function(){return l}});let l=(0,r(9205).Z)("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},6865:function(e,s,r){r.d(s,{Z:function(){return l}});let l=(0,r(9205).Z)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])}}]);